---
title: "Curvilinear/Polynomial Regression"
author: "Chetana Jamadar"
date: "2022-12-19"
output: html_document
---

1. Table 3 presents the data concerning the strength of Kraft paper and the % of hardwood in the
batch of pulp from which the paper was produced. Show that the quadratic model appears to
provide a good fit to the relationship between tensile strength and hardwood concentration.

```{r}

y=c(6.3,11.1,20,24,26.1,30,33.8,34,38.1,39.9,42,46.1,53.1,
52,52.5,48,42.8,27.8,21.9)
x=c(1,1.5,2,3,4,4.5,5,5.5,6,6.5,7,8,9,10,11,12,13,14,15)
plot(x,y)
Model_1=lm(y~x+I(x^2))
Model_1
#y=-6.6742+11.7640( x )+(-0.6345) I(x^2)  
summary(Model_1)
#centering the data
x_1=x-mean(x)
x_2=(x-mean(x))^2
Model_2=lm(y~x_1+I(x_2))
summary(Model_2)
library(car)
vif(Model_1)
vif(Model_2)
#These vifs are much larger than those for the centred data.Thus centering the linear terms #in a polynomial model removes some of nonessential ill-conditionaled by the choice 
#of origin for the regressor.
```
2. Fit the regression model as specified below for the data given in Table 2
y = β0 +β1x1 +β2x2 +β11x21 +β22x2^2 +β12x1x2
(a) Compute t-statistic for each model parameter and conclude on the significance of corresponding regression parameter.
(b) Use extra sum of squares method to evaluate the contribution of all the quadratic terms x21 x22
and x1x2 in regression sum of squares for the regression model fitted in (a). Also test itssignificance.
(c) Plot the residuals versus fitted values. Also have the Box plot of residuals to check the existence of any of the outlying observations.
```{r}
y=c(26,24,175,160,163,55,62,100,26,30,70,71)
x1=c(1,1,1.5,1.5,1.5,0.5,1.5,0.5,1,0.5,1,0.5)
x2=c(1,1,4,4,4,2,5,3,1.5,1.5,2.5,2.5)
d=data.frame(y,x1,x2)
plot(d)
fit=lm(y~x1+x2+I(x1^2)+I(x2^2)+I(x1*x2))
fit
summary(fit)
aov(fit)
ss_res_FM=655.841
ms_res_FM=ss_res_FM/6
fit1=lm(y~x1+x2)
fit1
aov(fit1)
summary(fit1)
ss_res_RM=14472.464
SSH=ss_res_RM-ss_res_FM
f=(SSH/3)/ms_res_FM
f
f_tab=qf(0.05,3,6,lower.tail = F)
f_tab
plot(fit$fitted.values,fit$residuals)
boxplot(fit$residuals)
#to find staderdised residuals
rstandard(fit)
#studentised residual
rstudent(fit)
#press residual
e=fit$residuals
h=hatvalues(fit)
e_=e/(1-h)

```



