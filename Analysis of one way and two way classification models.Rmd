---
title: "Analysis one way and two way classification model"
author: "Chetana Jamadar"
date: "2022-12-17"
output: html_document
---
1. A study was done to compare Pinot Noir wine made in three different regions. Wine samples from
each region were taken and scored by a panel of judges on the wine quality flavor. The higher the
number, the more favorable the rating.
Region 1 3.1 3.5 4.8 3.1 5.5 5.0 4.8 4.3 4.7 4.3 5.1 3.0 4.3 5.5 4.2 3.5 5.7
Region 2 4.3 3.4 5.0 4.1 4.7 5.0 5.0 2.9 5.0
Region 3 3.9 4.5 7.0 6.7 5.8 5.6 4.8 5.5 6.6 5.3 5.7 6.0
(a) Compare the flavor ratings for three different regions graphically using appropriate graph.
(b) Analyze the data using suitable model. Test whether the flavor ratings for different regions are significantly different.
(c) Obtain residuals and fitted values for this model.
```{r}
n1=17;
n2=9;
n3=12;
n=n1+n2+n3
x1=c(rep(1,n));
x2=c(rep(1,n1),rep(0,n2+n3));
x3=c(rep(0,n1),rep(1,n2),rep(0,n3));
x4=c(rep(0,n1+n2),rep(1,n3))
x=cbind(x1,x2,x3,x4)
x=matrix(c(x1,x2,x3),38,4,1);x;
library(Matrix)
r=rankMatrix(x)
r=r[1]
r#rank of x
#given model is non full rank model
library(MASS)
S=t(x)%*%x
G=ginv(S)
H=G%*%S
y1=c(3.1,3.5,4.8,3.1,5.5,5.0,4.8,4.3,4.7,4.3,5.1,3.0,4.3,5.5,4.2,3.5,5.7);
y1;
y2=c(4.3,3.4,5,4.1,4.7,5,5,2.9,5)
y3=c(3.9,4.5,7,6.7,5.8,5.6,4.8,5.5,6.6,5.3,5.7,6)
y=matrix(c(y1,y2,y3),n,1);y;
y_hat=x%*%beta_hat
e=y-y_hat
beta_hat=G%*%t(x)%*%y
beta_hat
SSE=t(e)%*%e
SSTret=t(beta_hat)%*%t(x)%*%y-n*mean(y)^2#Treatment sum of square.
TSS=t(y)%*%y-n*mean(y)^2
SST=SSE+SSTret
MSTreat=SSTret/(r-1)
MSE=SSE/(n-r)
F=MSTreat/MSE
F_tab=qf(0.05,r-1,n-r,lower.tail=0)
F_tab
boxplot(y1,y2,y3)
factor=c(rep("y1",n1),rep("y2",n2),rep("y3",n3));
data=data.frame(y,factor)
fit=aov(y~factor)
summary(fit)
TukeyHSD(fit,conf.level = 0.95)
R2=(SSTret/TSS)*100#Explained variability
R2
Unexplained=(SSE/TSS)*100
Unexplained

```

Question no:-2
2. The data in table aside shows the life of electric bulbs from four companies A, B, C and D. Prepare
analysis of variance table to find out whether the lives differ from company to company.
Company Life in Burning hours
A 1020 1010 1030 1000
B 1030 1040 1050 1030 1060
C 990 980 970 960 970 980
D 1040 1050 1030 1070
```{r}
n1=4;n2=5;n3=6;n4=4;
n=n1+n2+n3+n4;
x1=c(rep(1,n))
x2=c(rep(1,n1),rep(0,n2+n3+n4))
x3=c(rep(1,n1),rep(1,n2),rep(0,n3+n4))
x4=c(rep(0,n1),rep(1,n2),rep(0,n3+n4))
x5=c(rep(0,n1+n2+n3),rep(1,n4))
x=cbind(x1,x2,x3,x4,x5)
S=t(x)%*%x
library(Matrix)
r=rankMatrix(S)
r=r[1]
r
library(MASS)
G=ginv(S)
H=G%*%S
y1=c(1020,1010,1030,1000)
y2=c(1030,1040,1050,1030,1060)
y3=c(990,980,970,960,970,980)
y4=c(1040,1050,1030,1070)
Y=matrix(c(y1,y2,y3,y4),n,1)
beta_hat=G%*%t(x)%*%Y
Y_hat=x%*%beta_hat
e=Y-Y_hat
SSE=t(e)%*%e
SSTret=t(beta_hat)%*%t(x)%*%Y-n*mean(Y)^2
TSS=t(Y)%*%Y-n*mean(Y)^2
SST=SSE+SSTret
MSTreat=SSTret/(n-1)
MSE=SSE/(n-r)
F=MSTreat/MSE
F_tab=qf(0.05,r-1,n-r,lower.tail = FALSE)
F_tab
boxplot(y1,y2,y3,y4)
factor=c(rep("y1",n1),rep("y2",n2),rep("y3",n3),rep("y4",n4));
data=data.frame(y,factor)
fit=aov(Y~factor)
summary(fit)
TukeyHSD(fit,conf.level = 0.95)
R2=(SSTret/TSS)*100#Explained variability
R2
Unexplained=(SSE/TSS)*100
Unexplained

```
Que3)University of Wisconsin researcher tested the yields of six varieties of Alfalfa on each of four separate fields. The data is given in the following table.
Field  Variety
   A      B   C   D     E   F
1 3.22 3.04 3.06 2.64 3.19 2.49
2 3.31 2.99 3.17 2.75 3.40 2.37
3 3.26 3.27 2.93 2.59 3.11 2.38
4 3.25 3.20 3.09 2.62 3.23 2.37
(a) Using appropriate model test whether the yields of six varieties are significantly different.
(b) Do the yields from different fields differ significantly?
(c) Obtain the BLUEs and estimates of variance of BLUEs of contrast effects in variety and fields.
(d) Present the variation in average yield due to different varieties and fields graphically.
```{r}
y1=c(3.22,3.04,3.06,2.64,3.19,2.49)
y2=c(3.31,2.99,3.17,2.75,3.40,2.37)
y3=c(3.26,3.27,2.93,2.59,3.11,2.38)
y4=c(3.25,3.20,3.09,2.62,3.23,2.37)
boxplot(y1,y2,y3,y4)
n=length(y1)+length(y2)+length(y3)+length(y4)
Y=matrix(c(y1,y2,y3,y4),n,1)
field=c(rep("1",6),rep("2",6),rep("3",6),rep("4",6))
m=c("A","B","C","D","E","F")
variety=rep(m,4)
data=data.frame(Y,field,variety)
fit=aov(Y~field+variety,data=data)
fit
summary(fit)


```
4. The data given represents the results of an experiment performed to determine the effects of 4
different levels of each temperature and Alkali Percent on yield percent of pulp received from a cellulosic raw material.
(a) Present the variation in average yield due to different temperature and Alkali Percent graphically.
(b) Prepare analysis of variance table to find out whether the levels of temperature and Alkali percent differ significantly?

Temp →
% Alkali ↓
138 143 148 153
12 391 343 312 304
15 373 328 308 282
18 359 319 305 272
21 349 289 301 261
```{r}
rm(list=ls(all=TRUE))
s1=c(rep(1:4,rep(4,4)))
s2=rep(c("A","B","C","D"),4)
obs=c(391,343,312,304,373,328,308,282,359,319,305,272,349,289,301,261)
d=data.frame(s1,s2,obs)
alkali=factor(s1)
temp=factor(s2)
av2=aov(obs~alkali+temp);av2
summary(av2)ss
```



