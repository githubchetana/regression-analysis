---
title: "Multiple reg model extra sum of squares"
author: "Chetana Jamadar"
date: "2023-01-03"
output: html_document
---

1. As part of a study investigating the general health of college students, information was collected
from 17 college students. The corresponding data is given in Table 1. It includes age, height,
diastolic blood pressure (DBP), systolic blood pressure (SBP) and the volume of air exhaled after
one deep breath.
(a) Observe the relation among variables through the multiple-scatter plot.
(b) Fit a MLRM to the above data to regress volume of air on other variables recorded.
i. Test for significance of regression and draw the conclusion. Obtain R^2for the model.
Calculate fitted values, error vector and residuals.
ii. Obtain the normal probability plot of residuals for the fitted model.
iii. Obtain the variance covariance matrix of the estimated parameters.
(c) Split the regression sum of squares in 3 components of extra sum of squares as
SSR (X4), SSR (X1/X4) and SSR(X3,X2/X1,X4).
```{r}
#---Multiple Linear Regression--Extra Sum Of squares
rm(list=ls(all=TRUE))
AGE=c(22,19,23,31,21,41,27,26,18,34,31,28,24,20,21,19,35)
HEIGHT=c(175,152,165,162,193,137,182,162,172,160,172,160,163,185,190,168,137)
DBP=c(60,70,82,90,68,76,76,62,74,76,70,80,62,78,76,68,60)
SBP=c(122,102,118,108,120,104,120,116,118,102,112,122,118,124,120,102,106)
VOLUME=c(3.1,3.4,3,3.2,4.9,2.4,4.5,3.1,4.4,2.9,4.2,3,3,4.7,4.8,4.1,2.3)
data=data.frame(VOLUME,AGE,HEIGHT,DBP,SBP);data
plot(data)
#Fit the mlrm to the above regressor volume age on the other variable recorded.
Model_1=lm(VOLUME~AGE+HEIGHT+DBP+SBP)#FM
Model_1
############(i)########
summary(Model_1)
anova(Model_1)
#To test the DBP and SBP contributes significantly of the model
Model_2=lm(VOLUME~AGE+HEIGHT)
Model_2
summary(Model_2)
anova(Model_2)
ss_H=2.5207-1.9812
F_0=ss_H/2/0.1651
qf(0.05,2,12,lower.tail = F)
anova(Model_1,Model_2)
#To test the AGE and HEIGHT contributes significantly to test the model
Model_3=lm(VOLUME~DBP+SBP)
Model_3
summary(Model_3)
anova(Model_3)
##################(b)############################
#95%C.I.for regression coefficient
confint(Model_1,level=0.95)
######95% C.I. for mean response############
predict.lm(Model_1,interval = "confidence")
##################to check the normality##############
hist(Model_1$residuals)
qqnorm(Model_1$residuals)
ks.test(Model_1$residuals,"pnorm")
shapiro.test(Model_1$residuals)
library(nortest)
ad.test(Model_1$residuals)
par(mfrow=c(2,2))
plot(Model_1)
library(lmtest)
bptest(Model_1)
```
```{r}
#----Using GLM setup-------
y=matrix(c(y),n,1,0)
x=matrix(c(rep(1,n),x1,x2,x3,x4),17,5,0) # Design Matrix
r=rankMatrix(x)
r=r[1] # rank of x
s=t(x)%*%x
beta_hat=solve(s)%*%t(x)%*%y
yhat=x%*%beta_hat
#----Using direct setup--
fit=lm(y~x1+x2+x3+x4)
summary(fit)
aov(fit)
qf(0.05,k,n-p) # table value
1-pf(14.86,k,n-p) # p value
x=model.matrix(fit) # For design matrix
y=fit$fitted.values #fitted value
e=t(y-x%*%beta_hat) #residuals
e=t(fit$residuals)
sum(e)
#-----Qb)ii)---------
fit1=lm(y~x2)
summary(fit1)
shapiro.test(e)
plot(fit)
#-----Qb)iii)
Sigma_hat2= 1.981178/12 #(Residual standard error)^2
var_beta_hat=Sigma_hat2*solve(s)
var_beta_hat
#------Qc)i)--------------
t_01= -0.01586 /sqrt( 4.308352e-04)
t_01
t_table=qt(0.025,12,lower.tail=0)
t_table
t_02= 0.05303 /sqrt(1.087487e-04)
t_02
t_03= 0.00546 /sqrt( 1.604585e-04)
t_03
t_04= -0.02956 /sqrt( 2.956476e-04)
t_04
aov(fit)
 #-----Qb)ii)---------
summary(fit1)
shapiro.test(e)
 #-----Qb)iii)
Sigma_hat2= 1.981178/12 #(Residual standard error)^2
var_beta_hat
  #------Qc)i)--------------
t_01
t_table
```
(question 2 table 2)
2. 16 observations on the viscosity of a polymer(y)and two-process variables reaction temperature(X1) and catalyst feed rate (X2) are recorded and given in Table 2.
(a) Fit a multiple regression model to the above data. Estimate the variance-covariance matrix
of regression parameters.
(b) Test for significance of regression. Draw appropriate conclusions.
(c) Obtain the residual vector, variance-covariance matrix of residuals and have the normal probability plot of residuals.
(d) Test the significance of addition of process variable temperature given that the feed rate variable is already there in the regression       model i.e. split the regression sum of squares in twocomponents of extra sum of squares as SSR (X2) and SSR (X1/X2)
(e) Check whether you need both the regressor variables in the model?
(f ) Split the regression sum of squares in two components of extra sum of squares as
SSR (X1) and SSR (X2/X1).
```{r}
#---Multiple Linear Regression--Extra Sum Of squares Q2)
x1 =c(80,93,100,82,90,99,81,96,94,93,97,95,100,85,86,87)
x2=c(8,9,10,12,11,8,8,10,12,11,13,11,8,12,9,12)
y=c(2256,2340,2426,2293,2330,2368,2250,2409,2364,2379,2440,2364,2404,2317,2309,2328)
pairs(~y+x1+x2) #Matrix plot
fit=lm(y~x1+x2)
summary(fit)
x=model.matrix(fit) # For design matrix
s=t(x)%*%x
sigma_hat2=((16.36)^2)/13
solve(s)
var_beta_hat=sigma_hat2*solve(s)
aov(fit)
qf(0.05,k,n-p) # table value
1-pf(14.86,k,n-p) # p value
y=fit$fitted.values #fitted value
e=t(y-x%*%beta_hat) #residuals
e=t(fit$residuals)
sum(e)
solve(s)
sum(e)

```
table(1)
```{r}

```

